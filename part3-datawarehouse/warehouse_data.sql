USE fleximart_dw;
SET FOREIGN_KEY_CHECKS=0;
TRUNCATE TABLE fact_sales;
TRUNCATE TABLE dim_customer;
TRUNCATE TABLE dim_product;
TRUNCATE TABLE dim_date;
SET FOREIGN_KEY_CHECKS=1;

-- dim_date (30 rows: Jan-Feb 2024)
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240115, '2024-01-15', 'Monday', 15, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240116, '2024-01-16', 'Tuesday', 16, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240117, '2024-01-17', 'Wednesday', 17, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240118, '2024-01-18', 'Thursday', 18, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240119, '2024-01-19', 'Friday', 19, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240120, '2024-01-20', 'Saturday', 20, 1, 'January', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240121, '2024-01-21', 'Sunday', 21, 1, 'January', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240122, '2024-01-22', 'Monday', 22, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240123, '2024-01-23', 'Tuesday', 23, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240124, '2024-01-24', 'Wednesday', 24, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240125, '2024-01-25', 'Thursday', 25, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240126, '2024-01-26', 'Friday', 26, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240127, '2024-01-27', 'Saturday', 27, 1, 'January', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240128, '2024-01-28', 'Sunday', 28, 1, 'January', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240129, '2024-01-29', 'Monday', 29, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240130, '2024-01-30', 'Tuesday', 30, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240131, '2024-01-31', 'Wednesday', 31, 1, 'January', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240201, '2024-02-01', 'Thursday', 1, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240202, '2024-02-02', 'Friday', 2, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240203, '2024-02-03', 'Saturday', 3, 2, 'February', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240204, '2024-02-04', 'Sunday', 4, 2, 'February', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240205, '2024-02-05', 'Monday', 5, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240206, '2024-02-06', 'Tuesday', 6, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240207, '2024-02-07', 'Wednesday', 7, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240208, '2024-02-08', 'Thursday', 8, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240209, '2024-02-09', 'Friday', 9, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240210, '2024-02-10', 'Saturday', 10, 2, 'February', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240211, '2024-02-11', 'Sunday', 11, 2, 'February', 'Q1', 2024, 1);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240212, '2024-02-12', 'Monday', 12, 2, 'February', 'Q1', 2024, 0);
INSERT INTO dim_date (date_key, full_date, day_of_week, day_of_month, month, month_name, quarter, year, is_weekend) VALUES (20240213, '2024-02-13', 'Tuesday', 13, 2, 'February', 'Q1', 2024, 0);

-- dim_product (15 rows across 3 categories)
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P001', 'Samsung Galaxy S21', 'Electronics', 'Smartphones', 45999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P003', 'Apple MacBook Pro', 'Electronics', 'Laptops', 99999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P005', 'Sony Headphones', 'Electronics', 'Audio', 1999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P007', 'HP Laptop', 'Electronics', 'Laptops', 52999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P012', 'Dell Monitor 24inch', 'Electronics', 'Monitors', 12999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P014', 'iPhone 13', 'Electronics', 'Smartphones', 69999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P002', 'Nike Running Shoes', 'Fashion', 'Footwear', 3499.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P004', 'Levi''s Jeans', 'Fashion', 'Clothing', 2999.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P008', 'Adidas T-Shirt', 'Fashion', 'Clothing', 1299.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P011', 'Puma Sneakers', 'Fashion', 'Footwear', 4599.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P013', 'Woodland Shoes', 'Fashion', 'Footwear', 5499.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P006', 'Organic Almonds', 'Groceries', 'Dry Fruits', 899.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P009', 'Basmati Rice 5kg', 'Groceries', 'Staples', 650.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P015', 'Organic Honey 500g', 'Groceries', 'Condiments', 450.00);
INSERT INTO dim_product (product_id, product_name, category, subcategory, unit_price) VALUES ('P018', 'Masoor Dal 1kg', 'Groceries', 'Staples', 120.00);

-- dim_customer (12 rows across multiple cities/states)
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C001', 'Rahul Sharma', 'Bangalore', 'Karnataka', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C002', 'Priya Patel', 'Mumbai', 'Maharashtra', 'Premium');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C003', 'Amit Kumar', 'Delhi', 'Delhi', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C004', 'Sneha Reddy', 'Hyderabad', 'Telangana', 'Premium');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C005', 'Vikram Singh', 'Chennai', 'Tamil Nadu', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C006', 'Anjali Mehta', 'Bangalore', 'Karnataka', 'Premium');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C009', 'Karthik Nair', 'Kochi', 'Kerala', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C011', 'Arjun Rao', 'Hyderabad', 'Telangana', 'Premium');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C013', 'Suresh Patel', 'Mumbai', 'Maharashtra', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C014', 'Neha Shah', 'Ahmedabad', 'Gujarat', 'Retail');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C017', 'Rajesh Kumar', 'Delhi', 'Delhi', 'Premium');
INSERT INTO dim_customer (customer_id, customer_name, city, state, customer_segment) VALUES ('C020', 'Swati Desai', 'Pune', 'Maharashtra', 'Retail');

-- fact_sales (40 transactions)
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240210, 2, 1, 3, 99999.00, 14999.85, 284997.15);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240126, 4, 3, 3, 52999.00, 0.00, 158997.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 12, 9, 1, 899.00, 89.90, 809.10);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240117, 1, 2, 1, 45999.00, 0.00, 45999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240204, 10, 1, 2, 4599.00, 0.00, 9198.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240213, 11, 12, 2, 5499.00, 0.00, 10998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240125, 8, 10, 1, 2999.00, 0.00, 2999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 12, 7, 1, 899.00, 44.95, 854.05);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 4, 6, 1, 52999.00, 0.00, 52999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240131, 2, 6, 4, 99999.00, 0.00, 399996.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240210, 5, 1, 3, 12999.00, 3899.70, 35097.30);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240206, 2, 7, 1, 99999.00, 4999.95, 94999.05);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240127, 14, 11, 2, 450.00, 45.00, 855.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240208, 4, 12, 1, 52999.00, 0.00, 52999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 4, 5, 1, 52999.00, 0.00, 52999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240120, 7, 5, 2, 3499.00, 349.90, 6648.10);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 6, 6, 1, 69999.00, 3499.95, 66499.05);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240212, 15, 11, 3, 120.00, 0.00, 360.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240210, 11, 3, 2, 5499.00, 0.00, 10998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 8, 7, 1, 2999.00, 0.00, 2999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 6, 1, 1, 69999.00, 0.00, 69999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240128, 7, 5, 1, 3499.00, 0.00, 3499.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240208, 15, 12, 1, 120.00, 0.00, 120.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 8, 7, 3, 2999.00, 899.70, 8097.30);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 5, 3, 1, 12999.00, 649.95, 12349.05);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240209, 7, 10, 2, 3499.00, 0.00, 6998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240125, 3, 9, 2, 1999.00, 0.00, 3998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240118, 14, 2, 1, 450.00, 22.50, 427.50);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 13, 11, 2, 650.00, 0.00, 1300.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240131, 7, 10, 2, 3499.00, 349.90, 6648.10);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240127, 9, 1, 3, 1299.00, 0.00, 3897.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 15, 9, 4, 120.00, 24.00, 456.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240211, 6, 2, 1, 69999.00, 6999.90, 62999.10);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 8, 1, 3, 2999.00, 449.85, 8547.15);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240204, 13, 3, 2, 650.00, 0.00, 1300.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240210, 5, 11, 2, 12999.00, 0.00, 25998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240121, 6, 3, 2, 69999.00, 0.00, 139998.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240210, 6, 8, 1, 69999.00, 0.00, 69999.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240130, 15, 5, 1, 120.00, 0.00, 120.00);
INSERT INTO fact_sales (date_key, product_key, customer_key, quantity_sold, unit_price, discount_amount, total_amount) VALUES (20240126, 15, 10, 1, 120.00, 0.00, 120.00);